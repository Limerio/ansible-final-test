# SPDX-License-Identifier: MIT
---
- name: Start Apache (Debian)
  ansible.builtin.service:
    name: "{{ wordpress_httpd_service }}"
    state: started
  when: ansible_facts['os_family'] == 'Debian'

- name: Start Apache (RedHat - try systemd, fallback for container without systemd)
  when: ansible_facts['os_family'] == 'RedHat'
  block:
    - name: Start Apache via systemd
      ansible.builtin.service:
        name: "{{ wordpress_httpd_service }}"
        state: started
  rescue:
    - name: Start Apache via apachectl (container without systemd)
      ansible.builtin.command: /usr/sbin/apachectl start
      changed_when: true
      failed_when: false

- name: Start MariaDB (Debian)
  ansible.builtin.service:
    name: "{{ mariadb_service }}"
    state: started
  when: ansible_facts['os_family'] == 'Debian'

- name: Start MariaDB (RedHat - try systemd, fallback for container without systemd)
  when: ansible_facts['os_family'] == 'RedHat'
  block:
    - name: Start MariaDB via systemd
      ansible.builtin.service:
        name: "{{ mariadb_service }}"
        state: started
  rescue:
    - name: Start MariaDB daemon (container without systemd)
      ansible.builtin.command: /usr/sbin/mariadbd --user=mysql --daemonize
      changed_when: true
      failed_when: false
